{"version":3,"file":"worker.mjs","sources":["../src/worker.ts"],"sourcesContent":["import {Env} from \"../bindings\";\nimport {GetDataResponse} from \"private-api-worker/src/Data\";\nexport default {\n\tasync fetch(request: Request, env: Env, ctx: ExecutionContext): Promise<Response> {\n\n\t\tif(request.method === 'GET'){\n\n\t\t\tconst url = new URL(request.url);\n\t\t\tconst init:RequestInit = {\n\t\t\t\theaders: {\n\t\t\t\t\t\"content-type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tmethod: \"GET\"\n\t\t\t};\n\n\t\t\tconst newRequestInit = {\n\t\t\t\t// Change method\n\t\t\t\tmethod: \"GET\",\n\t\t\t\t// Change body\n\t\t\t\t// body: JSON.stringify({ bar: \"foo\" }),\n\t\t\t\t// Change the redirect mode.\n\t\t\t\t// redirect: \"follow\",\n\t\t\t\t// Change headers, note this method will erase existing headers\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\t// Change a Cloudflare feature on the outbound response\n\t\t\t\tcf: { apps: false },\n\t\t\t};\n\t\t\tconst nameKey = url.searchParams.get(\"name\");\n\t\t\tconst newRequest = new Request(\n\t\t\t\tnew URL(url.searchParams.get(\"name\")!, \"http://test.destination.local\"),\n\t\t\t\tnewRequestInit\n\t\t\t);\n\t\t\tif(nameKey !== null){\n\t\t\t\t// const response = await env.PRIVATE_API.fetch(newRequest);\n\t\t\t\t// const response = await env.PRIVATE_API.fetch(`/data/${url.searchParams.get(\"name\")}`, init);\n\t\t\t\tconst response = await env.PRIVATE_API.fetch(newRequest);\n\t\t\t\tconst data = await response.json<GetDataResponse>();\n\t\t\t\treturn new Response(JSON.stringify(data));\n\t\t\t}\n\t\t\treturn new Response(JSON.stringify({\n\t\t\t\terror: \"please provide name\"\n\t\t\t}));\n\t\t}\n\t\telse{\n\t\t\treturn new Response(JSON.stringify({\n\t\t\t\terror: `${request.method} is not supported`\n\t\t\t}));\n\t\t}\n\n\t},\n};\n"],"names":[],"mappings":"AAEA,aAAe;AACd,IAAA,MAAM,KAAK,CAAC,OAAgB,EAAE,GAAQ,EAAE,GAAqB,EAAA;AAE5D,QAAA,IAAG,OAAO,CAAC,MAAM,KAAK,KAAK,EAAC;YAE3B,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;AAQjC,YAAA,MAAM,cAAc,GAAG;;AAEtB,gBAAA,MAAM,EAAE,KAAK;;;;;;AAMb,gBAAA,OAAO,EAAE;AACR,oBAAA,cAAc,EAAE,kBAAkB;AAClC,iBAAA;;AAED,gBAAA,EAAE,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE;aACnB,CAAC;YACF,MAAM,OAAO,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC7C,MAAM,UAAU,GAAG,IAAI,OAAO,CAC7B,IAAI,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAE,EAAE,+BAA+B,CAAC,EACvE,cAAc,CACd,CAAC;YACF,IAAG,OAAO,KAAK,IAAI,EAAC;;;gBAGnB,MAAM,QAAQ,GAAG,MAAM,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;AACzD,gBAAA,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAmB,CAAC;gBACpD,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;AAC1C,aAAA;AACD,YAAA,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC;AAClC,gBAAA,KAAK,EAAE,qBAAqB;AAC5B,aAAA,CAAC,CAAC,CAAC;AACJ,SAAA;AACG,aAAA;AACH,YAAA,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC;AAClC,gBAAA,KAAK,EAAE,CAAA,EAAG,OAAO,CAAC,MAAM,CAAmB,iBAAA,CAAA;AAC3C,aAAA,CAAC,CAAC,CAAC;AACJ,SAAA;KAED;CACD;;;;"}